<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.8" />
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true)
      }
    </script>
    <title>Chapter 15 Write The Comments First | A Philosophy of Software Design, 2nd Edition</title><meta name="description" content="">
    <link rel="preload" href="/aposd2e-zh/assets/style-BBqKdvbw.css" as="style"><link rel="stylesheet" href="/aposd2e-zh/assets/style-BBqKdvbw.css">
    <link rel="modulepreload" href="/aposd2e-zh/assets/app-OzoTqpES.js"><link rel="modulepreload" href="/aposd2e-zh/assets/ch15.html-Bg6Beyhl.js">
    <link rel="prefetch" href="/aposd2e-zh/assets/index.html-DWKNUl7f.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch01.html-Bl7FX9NY.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch02.html-BtTCxofi.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch03.html-DpEiaYzl.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch04.html-zvgHdESs.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch05.html-BRhPIWnd.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch06.html-CrIuMbQY.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch07.html-BKMiPK-I.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch08.html-CqoSuP4M.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch09.html-DhpnUYPR.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch10.html--HgDZyrE.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch11.html-B-PBI_B-.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch12.html-CSFbfad5.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch13.html-Zqkf-SdV.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch14.html-C7fWahsH.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch15.html-BdIov09R.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch16.html-0GQEvgno.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch17.html-mMITZGcY.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch18.html-BXRpW273.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch19.html-D8__YLz5.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch20.html-BviUb96p.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch21.html-C_D_Nme8.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch22.html-CX4P7bHW.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/preface.html-BSMTJF-g.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/summary.html-C_ZTIrTs.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/index.html-BfcA1w49.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch01.html-CcYY-pT3.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch02.html-W5v4wqV8.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch03.html-DNW1hEm7.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch04.html-kGSmYept.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch05.html-rM5y5nk6.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch06.html-DaOt_hWW.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch07.html-HHBJ-yGI.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch08.html-CK9AKGLK.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch09.html-Gtfy8Bfs.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch10.html-CFXJaLUC.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch11.html-CshGYTlL.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch12.html-qWcNoo1g.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch13.html-BTQfI4da.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch14.html-yKNP_fhr.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch16.html-D5SGj16G.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch17.html-Cbo0C87F.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch18.html-CCwxs_tu.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch19.html-hoEWk5Nz.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch20.html-1GrtAONZ.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch21.html-CzSdJUhH.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/ch22.html-BKJDqxLT.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/preface.html-BhmAAbsU.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/summary.html-CiavbRM4.js" as="script"><link rel="prefetch" href="/aposd2e-zh/assets/404.html-uNfLsHj3.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/aposd2e-zh/en/"><!----><span class="site-name" aria-hidden="true">A Philosophy of Software Design, 2nd Edition</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide" aria-label="site navigation"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/aposd2e-zh/ch15.html" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link route-link-active" href="/aposd2e-zh/" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/yingang/aposd2e-zh" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items" aria-label="site navigation"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/aposd2e-zh/ch15.html" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link route-link-active" href="/aposd2e-zh/" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/yingang/aposd2e-zh" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">Chapter 15 Write The Comments First <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/aposd2e-zh/#_15-1-delayed-comments-are-bad-comments" aria-label="15.1 Delayed comments are bad comments"><!--[--><!--]--> 15.1 Delayed comments are bad comments <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/aposd2e-zh/#_15-2-write-the-comments-first" aria-label="15.2 Write the comments first"><!--[--><!--]--> 15.2 Write the comments first <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/aposd2e-zh/#_15-3-comments-are-a-design-tool" aria-label="15.3 Comments are a design tool"><!--[--><!--]--> 15.3 Comments are a design tool <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/aposd2e-zh/#_15-4-early-comments-are-fun-comments" aria-label="15.4 Early comments are fun comments"><!--[--><!--]--> 15.4 Early comments are fun comments <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/aposd2e-zh/#_15-5-are-early-comments-expensive" aria-label="15.5 Are early comments expensive?"><!--[--><!--]--> 15.5 Are early comments expensive? <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/aposd2e-zh/#_15-6-conclusion" aria-label="15.6 Conclusion"><!--[--><!--]--> 15.6 Conclusion <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="chapter-15-write-the-comments-first" tabindex="-1"><a class="header-anchor" href="#chapter-15-write-the-comments-first"><span>Chapter 15 Write The Comments First</span></a></h1><p>(Use Comments As Part Of The Design Process)</p><p>Many developers put off writing documentation until the end of the development process, after coding and unit testing are complete. This is one of the surest ways to produce poor quality documentation. The best time to write comments is at the beginning of the process, as you write the code. Writing the comments first makes documentation part of the design process. Not only does this produce better documentation, but it also produces better designs and it makes the process of writing documentation more enjoyable.</p><h2 id="_15-1-delayed-comments-are-bad-comments" tabindex="-1"><a class="header-anchor" href="#_15-1-delayed-comments-are-bad-comments"><span>15.1 Delayed comments are bad comments</span></a></h2><p>Almost every developer I have ever met puts off writing comments. When asked why they don’t write documentation earlier, they say that the code is still changing. If they write documentation early, they say, they’ll have to rewrite it when the code changes; better to wait until the code stabilizes. However, I suspect that there is also another reason, which is that they view documentation as drudge work; thus, they put it off as long as possible.</p><p>Unfortunately, this approach has several negative consequences. First, delaying documentation often means that it never gets written at all. Once you start delaying, it’s easy to delay a bit more; after all, the code will be even more stable in a few more weeks. By the time the code has inarguably stabilized, there is a lot of it, which means the task of writing documentation has become huge and even less attractive. There’s never a convenient time to stop for a few days and fill in all of the missing comments, and it’s easy to rationalize that the best thing for the project is to move on and fix bugs or write the next new feature. This will create even more undocumented code.</p><p>Even if you do have the self-discipline to go back and write the comments (and don’t fool yourself: you probably don’t), the comments won’t be very good. By this time in the process, you have checked out mentally. In your mind, this piece of code is done; you are eager to move on to your next project. You know that writing comments is the right thing to do, but it’s no fun. You just want to get through it as quickly as possible. Thus, you make a quick pass over the code, adding just enough comments to look respectable. By now, it’s been a while since you designed the code, so your memories of the design process are becoming fuzzy. You look at the code as you are writing the comments, so the comments repeat the code. Even if you try to reconstruct the design ideas that aren’t obvious from the code, there will be things you don’t remember. Thus, the comments are missing some of the most important things they should describe.</p><h2 id="_15-2-write-the-comments-first" tabindex="-1"><a class="header-anchor" href="#_15-2-write-the-comments-first"><span>15.2 Write the comments first</span></a></h2><p>I use a different approach to writing comments, where I write the comments at the very beginning:</p><ul><li>For a new class, I start by writing the class interface comment.</li><li>Next, I write interface comments and signatures for the most important public methods, but I leave the method bodies empty.</li><li>I iterate a bit over these comments until the basic structure feels about right.</li><li>At this point I write declarations and comments for the most important class instance variables in the class.</li><li>Finally, I fill in the bodies of the methods, adding implementation comments as needed.</li><li>While writing method bodies, I usually discover the need for additional methods and instance variables. For each new method I write the interface comment before the body of the method; for instance variables I fill in the comment at the same time that I write the variable declaration.</li></ul><p>When the code is done, the comments are also done. There is never a backlog of unwritten comments.</p><p>The comments-first approach has three benefits. First, it produces better comments. If you write the comments as you are designing the class, the key design issues will be fresh in your mind, so it’s easy to record them. It’s better to write the interface comment for each method before its body, so you can focus on the method’s abstraction and interface without being distracted by its implementation. During the coding and testing process you will notice and fix problems with the comments. As a result, the comments improve over the course of development.</p><h2 id="_15-3-comments-are-a-design-tool" tabindex="-1"><a class="header-anchor" href="#_15-3-comments-are-a-design-tool"><span>15.3 Comments are a design tool</span></a></h2><p>The second, and most important, benefit of writing the comments at the beginning is that it improves the system design. Comments provide the only way to fully capture abstractions, and good abstractions are fundamental to good system design. If you write comments describing the abstractions at the beginning, you can review and tune them before writing implementation code. To write a good comment, you must identify the essence of a variable or piece of code: what are the most important aspects of this thing? It’s important to do this early in the design process; otherwise you are just hacking code.</p><p>Comments serve as a canary in the coal mine of complexity. If a method or variable requires a long comment, it is a red flag that you don’t have a good abstraction. Remember from Chapter 4 that classes should be deep: the best classes have very simple interfaces yet implement powerful functions. The best way to judge the complexity of an interface is from the comments that describe it. If the interface comment for a method provides all the information needed to use the method and is also short and simple, that indicates that the method has a simple interface. Conversely, if there’s no way to describe a method completely without a long and complicated comment, then the method has a complex interface. You can compare a method’s interface comment with the implementation to get a sense of how deep the method is: if the interface comment must describe all the major features of the implementation, then the method is shallow. The same idea applies to variables: if it takes a long comment to fully describe a variable, it’s a red flag that suggests you may not have chosen the right variable decomposition. Overall, the act of writing comments allows you to evaluate your design decisions early, so you can discover and fix problems.</p><p>img Red Flag: Hard to Describe img</p><p>The comment that describes a method or variable should be simple and yet complete. If you find it difficult to write such a comment, that’s an indicator that there may be a problem with the design of the thing you are describing.</p><p>Of course, comments are only a good indicator of complexity if they are complete and clear. If you write a method interface comment that doesn’t provide all the information needed to invoke the method, or one that is so cryptic that it’s hard to understand, then that comment doesn’t provide a good measure of the method’s depth.</p><h2 id="_15-4-early-comments-are-fun-comments" tabindex="-1"><a class="header-anchor" href="#_15-4-early-comments-are-fun-comments"><span>15.4 Early comments are fun comments</span></a></h2><p>The third and final benefit of writing comments early is that it makes comment-writing more fun. For me, one of the most enjoyable parts of programming is the early design phase for a new class, where I’m fleshing out the abstractions and structure for the class. Most of my comments are written during this phase, and the comments are how I record and test the quality of my design decisions. I’m looking for the design that can be expressed completely and clearly in the fewest words. The simpler the comments, the better I feel about my design, so finding simple comments is a source of pride. If you are programming strategically, where your main goal is a great design rather than just writing code that works, then writing comments should be fun, since that’s how you identify the best designs.</p><h2 id="_15-5-are-early-comments-expensive" tabindex="-1"><a class="header-anchor" href="#_15-5-are-early-comments-expensive"><span>15.5 Are early comments expensive?</span></a></h2><p>Now let’s revisit the argument for delaying comments, which is that it avoids the cost of reworking the comments as the code evolves. A simple back-of-the-envelope calculation will show that this doesn’t save much. First, estimate the total fraction of development time that you spend typing in code and comments together, including time to revise code and comments; it’s unlikely that this will be more than about 10% of all development time. Even if half of your total code lines are comments, writing comments probably doesn’t account for more than about 5% of your total development time. Delaying the comments until the end will save only a fraction of this, which isn’t very much.</p><p>Writing the comments first will mean that the abstractions will be more stable before you start writing code. This will probably save time during coding. In contrast, if you write the code first, the abstractions will probably evolve as you code, which will require more code revisions than the comments-first approach. When you consider all of these factors, it’s possible that it might be faster overall to write the comments first.</p><h2 id="_15-6-conclusion" tabindex="-1"><a class="header-anchor" href="#_15-6-conclusion"><span>15.6 Conclusion</span></a></h2><p>If you haven’t ever tried writing the comments first, give it a try. Stick with it long enough to get used to it. Then think about how it affects the quality of your comments, the quality of your design, and your overall enjoyment of software development. After you have tried this for a while, let me know whether your experience matches mine, and why or why not.</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><!----></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/aposd2e-zh/assets/app-OzoTqpES.js" defer></script>
  </body>
</html>
